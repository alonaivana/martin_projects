# martin_projects
My working projects from Martin

# API merchcontrol

1. Установить зависимости (pip install -r requirements)
2. Запустить (python run.py)
3. В контейнере требуется правильное время

__Скрипты для загрузки данных о визитах мерчендайзеров в торговые точки из сервиса WODO,__ 
__ежедневного добавления информации о новых визитах в базу данных merchcontrol__
__и создания и отправки Excel-файла с данными за половину месяца каждое__ 
__3 и 18 число месяца на электронную почту отдела мерчендайзинга.__



*requirements.txt* - файл с зависимостями (необходимыми библиотеками и расширениями для корректной работы скрипта)

*settings.py* - константы (нет в открытом доступе)

__run.py__ - основной скрипт: 
         бот, запускающий ежедневную загрузку данных в базу SQL во время, равное TIME_TO_LOAD_SQL (settings.py)
         (загружаются данные, начиная от даты последнего обновления базы SQL до даты на два дня назад от текущей: 3 числа крайние получаемые данные - за 1 число);
         формирование и отправку на почту Excel-файла за промежутки 1-15 и 16-последнее число месяца каждое 18 и 3 число месяца соответственно 
         во время, равное TIME_TO_CREATE_EXCEL (settings.py)

*api.py* - описание функций для подключения к сервису WODO и получения отчёта за требуемые сутки

*sql_connection.py* - описание функции для подключения к базе данных SQL

*check_unique.py* - описание функций для проверки того, что данные, полученные от WODO, не были загружены в базу данных ранее

*new_people.py* - добавление в базу новых мерчандайзеров

*sql.py* - описание функций для получения даты последнего обновления базы данных SQL и загрузки в неё информации о визитах

*visits.py* - описание единой функции для получения данных о визитах и загрузки их в базу данных SQL (состоит из функций, описанных в предыдущих .py-файлах)

*get_date_range.py* -  описание функций для определения временного промежутка, данные за который загружаются в Excel-файл

*sql_to_excel.py* - описание функций для получения необходимых данных за требуемый период из базы SQL и формирования Excel-файла

*email_excel.py* - описание функций для отправки Excel-файла на электронную почту

*run_excel.py* - описание единой функции для создания, отправки на электронную почту и удаления Excel-файла
